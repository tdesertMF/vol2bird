
# the number of layers in an altitude profile
NLAYER = 25

# the width/thickness of a layer [m]
HLAYER = 200.0

# the minimum range [m] used for constructing the bird density profile
RANGEMIN = 5000.0

# the maximum range [m] used for constructing the bird density profile
RANGEMAX = 35000.0

# the minimum azimuth [degrees] used for constructing the bird density profile
AZIMMIN = 0.0

# the maximum range [degrees] used for constructing the bird density profile
AZIMMAX = 360.0

# the minimum scan elevation [degrees] used for constructing the bird density profile
ELEVMIN = 0.0

# the maximum scan elevation used for constructing the bird density profile
ELEVMAX = 90.0

# the wavelength [cm] of the radar
RADAR_WAVELENGTH_CM = 5.3

# whether a static clutter map is used
USE_CLUTTERMAP = FALSE

# filename (and path) of static clutter map
CLUTTERMAP = "your/file/here/myfile.h5"

# cells with clutter fractions above this value are likely not birds
CLUTPERCCELL = 0.5

# sample volumes in the static cluttermap with a value above this threshold will be considered clutter-contaminated
CLUTTERVALUEMIN = 0.1

# print options to stderr
PRINT_OPTIONS = FALSE 

# print dbz to stderr
PRINT_DBZ = FALSE

# print vrad to stderr
PRINT_VRAD = FALSE 

# print cell to stderr
PRINT_CELL = FALSE 

# print cell properties to stderr
PRINT_CELL_PROP = FALSE 

# print texture to stderr
PRINT_TEXTURE = FALSE 

# print clutter to stderr
PRINT_CLUT = FALSE 

# print profile data to stderr
PRINT_PROFILE = FALSE 

# whether or not to print the 'points' array
PRINT_POINTS_ARRAY = FALSE 

# Whether or not to fit a model to the observed vrad
FIT_VRAD = TRUE

# Whether to export bird profile as JSON
EXPORT_BIRD_PROFILE_AS_JSON = FALSE

# Minimum Nyquist velocity, scans with Nyquist velocity below this threshold are ignored
MIN_NYQUIST_VELOCITY = 5.0

# Scans with Nyquist velocity higher than this threshold are not dealiased
MAX_NYQUIST_DEALIAS = 25.0

# VVP Radial velocity standard deviation threshold
STDEV_BIRD = 2.0

# Bird radar cross section [cm^2]
SIGMA_BIRD = 11.0

# Maximum mean reflectivity [cm^2/km^3] for cells containing birds
ETACELL = 11500.0

# Maximum reflectivity [cm^2/km^3] for gates containing birds
ETAMAX = 36000.0

# reflectivity quantity to use, one of DBZH, DBZV, TH, TV
DBZTYPE = DBZH 

# for a range gate to contribute it should have a valid radial velocity
REQUIRE_VRAD = FALSE

# dealias the radial velocities using the torus mapping method by Haase et al.
DEALIAS_VRAD = FALSE

# whether to use dual-pol moments for filtering meteorological echoes
DUALPOL = TRUE 

# whether to use single-pol moments for filtering meteorological echoes
SINGLEPOL = TRUE 

# correlation coefficients higher than this threshold will be classified as precipitation
RHOHVMIN = 0.95

# whether to resample the input polar volume. Downsampling speeds up the calculation
RESAMPLE = FALSE

# resampled range gate length in m. Ignored when RESAMPLE = FALSE
RESAMPLE_RSCALE = 500.0

# resampled number of range bins. Ignored when RESAMPLE = FALSE
RESAMPLE_NBINS = 100

# resampled number of azimuth bins. Ignored when RESAMPLE = FALSE
RESAMPLE_NRAYS = 360

# whether to use MistNet segmentation model for pixel-based classification of weather and biology
USE_MISTNET = FALSE

# elevation scans to feed into mistnet segmentation model
# model expects {0.5, 1.5, 2.5, 3.5, 4.5}
MISTNET_ELEVS = {0.5, 1.5, 2.5, 3.5, 4.5}

# use only the specified elevation scans for mistnet to calculate profile if TRUE
# otherwise, use all available elevation scans
MISTNET_ELEVS_ONLY = TRUE

# location of mistnet model in pytorch format
MISTNET_PATH = "your/file/here/for/example/mistnet_v4.pt"

# when analyzing cells, AREACELL determines the minimum size of a cell to be considered in the rest of the analysis [km^2]
AREACELL = 0.5

# minimum standard deviation of the svdfit
CHISQMIN = 1e-5

# each weather cell identified by findWeatherCells() is grown by a distance equal to 'fringeDist' using a region-growing approach
FRINGEDIST = 5000.0

# when determining whether there are enough vrad observations in each direction, use NBINSGAP sectors
NBINSGAP =  8

# when calculating the altitude-layer averaged dbz, there should be at least NDBZMIN valid data points
NDBZMIN = 25

# the minimum number of direct neighbors with dbz value above dbzThresMin as used in findWeatherCells()
NEIGHBORS = 5

# there should be at least NOBSGAPMIN vrad observations in each sector
NOBSGAPMIN = 5

# vrad's texture is calculated based on the local neighborhood. The neighborhood size in the azimuth direction is equal to NTEXBINAZIM
NTEXBINAZIM = 3

# vrad's texture is calculated based on the local neighborhood. The neighborhood size in the range direction is equal to NTEXBINRANG
NTEXBINRANG = 3

# the minimum number of neighbors for the texture value to be considered valid, as used in calcTexture()
NTEXMIN = 4

# the refractive index of water
REFRACTIVE_INDEX_OF_WATER = 0.964

# after fitting the vrad data, throw out any vrad observations that are more that VDIFMAX away from the fitted value, since these are likely outliers
VDIFMAX = 10.0

# When analyzing cells, radial velocities lower than VRADMIN are treated as clutter
VRADMIN = 1.0


#########################################################################################################################SOME OPTIONS ARE STILL HARD CODED (with macros)
#########Those declarations can be found in constants.h

##vol2bird related variables
#// initialization value of rain segmentation field (CELL)
##define CELLINIT -1
#// standard refraction coefficient (4/3)
##define REFRACTION_COEFFICIENT 1.333333f
#// earth's radius (taken from NARR GRIB file)
##define EARTH_RADIUS 6371200 
#// range gates up to a distance of RANGE_MAX+RCELLMAX_OFFSET are read into memory
#// the extra offset allows for the raincell search to extend somewhat further
#// than the maximum range used in the profile generation (RANGE_MAX).
##define RCELLMAX_OFFSET 5000.0f
#// smallest range bin size to accept in metres
##define RSCALEMIN 10
#// default VVP Radial velocity standard deviation threshold S-band (>= 7.5 cm)
##define STDEV_BIRD_S 1.0f
#// name of (optional) environmental variable containing path to user configuration file
##define OPTIONS_CONF "OPTIONS_CONF"
#// default user configuration file name to search for in working directory
##define OPTIONS_FILE "options.conf"
#// FIXME: add description
##define VERBOSE_OUTPUT_REQUIRED 0
#// print aliased and dealiased vrad pairs to stderr
##define PRINT_DEALIAS 0
#// print rhohv to stderr
##define PRINT_RHOHV 0
#// when analyzing cells, only cells for which the stddev of vrad
#// (aka the texture) is less than cellStdDevMax are considered in the
#// rest of the analysis
##define STDEV_CELL 5.0f
#// minimum dbz of a gate to be considered for inclusion in a weather cell
##define DBZMIN 0.0
#// whether we should dealias all data once (default), or dealias for each profile individually
##define DEALIAS_RECYCLE 1
#// Test dealiasing field velocities up to VMAX m/s 
##define DEALIAS_VMAX 50.0
#// Test field velocities increase in steps VMAX/VAF
##define DEALIAS_VAF 15.0
#// Test field directions increase by 360/NF degrees
##define DEALIAS_NF 12.0

##MistNet related variables
#// initializing value of mistnet tensor
#define MISTNET_INIT 0
#// require that radial velocity and spectrum width pixels rendered as mistnet input
#// have a valid corresponding reflectivity value
##define MISTNET_REQUIRE_DBZ 0
#// resolution of the Cartesian grid in meter for Mistnet
##define MISTNET_RESOLUTION 500
#// X and Y dimension of the Cartesian grid for Mistnet,
#// including a 4 pixel padding around the image, i.e. 8
#// additional pixels.
##define MISTNET_DIMENSION 608
#// number of pixels in MISTNET_DIMENSION used as a bleed 
##define MISTNET_BLEED 8
#// number of MistNet elevation scans expected
##define MISTNET_N_ELEV 5
#// predict a pixel as rain if the class probability for rain exceeds this threshold
##define MISTNET_WEATHER_THRESHOLD 0.45
#// predict a pixel as rain if the average class probability for rain across
#// all five elevations at that spatial location exceeds this threshold
##define MISTNET_SCAN_AVERAGE_WEATHER_THRESHOLD 0.45
#// MistNet tensor indices for the background, biology and weather class probabilities
##define MISTNET_BACKGROUND_INDEX 0
##define MISTNET_BIOLOGY_INDEX 1
##define MISTNET_WEATHER_INDEX 2
#// value reserved in the weather cell map for pixels identified by MistNet as weather
##define MISTNET_WEATHER_CELL_VALUE 2

##OTHER VARIABLES
#// maximum number of input files
#define INPUTFILESMAX 50
#// Raw value used for gates or layers void of data (never ra-diated)
##define UNDETECT -999
#// Raw value used for gates or layers when below the measurement detection threshold
#// or when information could not be retrieved (radiated but nothing detected or calculated)
##define NODATA -1000
#// name under which the calculated texture quantity will be stored
##define TEXNAME "VTEX"
#// name under which the calculated raincell masking quantity will be stored
##define CELLNAME "CELL"
#// name of the parameter containing the static cluttermap
##define CLUTNAME "OCCULT"
#// Name of the program, to be stored as task attribute in ODIM
##define PROGRAM "vol2bird"
#// Version of the program, to be stored as task_version attribute in ODIM
##define VERSION "0.5.0.9187"
#// Date of latest version of the program
##define VERSIONDATE "15-Feb-2022"

